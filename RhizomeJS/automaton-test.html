<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/automaton.js"></script>
    
    <script>

        var state1 = {
            eventSink: undefined,
            plant: undefined,
            enter: function() {
                console.log("s1: enter");
            },
            work : function() {
                console.log("s1: working on the " + this.plant.name);
                this.eventSink.castEvent("e1");
            }
        };
        
        var state2 = {
            eventSink: undefined,
            plant: undefined,
            exit: function () {
                console.log("s2: exit");
            },
            work : function() {
                console.log("s2: working on the " + this.plant.name);
                this.eventSink.goBack();
//                this.eventSink.castEvent("e2");
            }
        };


        function TestAutomaton() {
            this.work = function () {
                this.getState().work();
            };
            
        }
        var plant = { name: "Plant" };
        TestAutomaton.prototype = new StackAutomaton(plant);
        
        var automaton = new TestAutomaton();

        automaton.addState("s1", state1);
        automaton.addState("s2", state2);

        automaton.addEdge("s1", "e1", "s2");
        automaton.addEdge("s2", "e2", "s1");
        
        automaton.setInitState("s1");
        
        automaton.work();
        automaton.work();

    </script>
</head>
<body>

</body>
</html>
